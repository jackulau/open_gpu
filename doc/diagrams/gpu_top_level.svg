<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 580" width="800" height="580">
  <defs>
    <style>
      .title { font-family: -apple-system, 'Helvetica Neue', sans-serif; font-size: 16px; font-weight: 600; fill: #111; }
      .heading { font-family: -apple-system, 'Helvetica Neue', sans-serif; font-size: 11px; font-weight: 600; fill: #fff; }
      .label { font-family: -apple-system, 'Helvetica Neue', sans-serif; font-size: 10px; fill: #fff; }
      .label-dark { font-family: -apple-system, 'Helvetica Neue', sans-serif; font-size: 10px; fill: #333; }
      .label-muted { font-family: -apple-system, 'Helvetica Neue', sans-serif; font-size: 9px; fill: #666; }
      .section-label { font-family: -apple-system, 'Helvetica Neue', sans-serif; font-size: 10px; font-weight: 500; fill: #555; }
    </style>
  </defs>

  <!-- Background -->
  <rect x="0" y="0" width="800" height="580" fill="#fff"/>

  <!-- Title -->
  <text x="400" y="28" text-anchor="middle" class="title">OpenGPU Top-Level Architecture</text>

  <!-- Host Interface -->
  <rect x="320" y="48" width="160" height="36" fill="#7c3aed"/>
  <text x="400" y="70" text-anchor="middle" class="heading">Host Interface</text>
  <text x="400" y="81" text-anchor="middle" class="label" opacity="0.8">AXI-Lite</text>

  <!-- Arrow to Scheduler -->
  <line x1="400" y1="84" x2="400" y2="100" stroke="#333" stroke-width="1.5"/>
  <polygon points="400,108 396,100 404,100" fill="#333"/>

  <!-- Global Scheduler -->
  <rect x="260" y="108" width="280" height="36" fill="#374151"/>
  <text x="400" y="130" text-anchor="middle" class="heading">Global Scheduler</text>
  <text x="400" y="141" text-anchor="middle" class="label" opacity="0.8">Kernel Dispatch / Block Distribution</text>

  <!-- Section label for SM array -->
  <text x="400" y="165" text-anchor="middle" class="section-label">Streaming Multiprocessor Array</text>

  <!-- SM Row 1 -->
  <g>
    <rect x="40" y="178" width="170" height="88" fill="#2563eb"/>
    <text x="125" y="198" text-anchor="middle" class="heading">SM 0</text>
    <line x1="55" y1="206" x2="195" y2="206" stroke="#fff" stroke-width="0.5" opacity="0.4"/>
    <text x="125" y="222" text-anchor="middle" class="label">4 Cores / 16 Warps</text>
    <text x="125" y="236" text-anchor="middle" class="label" opacity="0.7">L1 I$ 16KB / L1 D$ 32KB</text>
    <text x="125" y="250" text-anchor="middle" class="label" opacity="0.7">Shared Mem 64KB</text>
  </g>

  <g>
    <rect x="220" y="178" width="170" height="88" fill="#2563eb"/>
    <text x="305" y="198" text-anchor="middle" class="heading">SM 1</text>
    <line x1="235" y1="206" x2="375" y2="206" stroke="#fff" stroke-width="0.5" opacity="0.4"/>
    <text x="305" y="222" text-anchor="middle" class="label">4 Cores / 16 Warps</text>
    <text x="305" y="236" text-anchor="middle" class="label" opacity="0.7">L1 I$ 16KB / L1 D$ 32KB</text>
    <text x="305" y="250" text-anchor="middle" class="label" opacity="0.7">Shared Mem 64KB</text>
  </g>

  <g>
    <rect x="410" y="178" width="170" height="88" fill="#2563eb"/>
    <text x="495" y="198" text-anchor="middle" class="heading">SM 2</text>
    <line x1="425" y1="206" x2="565" y2="206" stroke="#fff" stroke-width="0.5" opacity="0.4"/>
    <text x="495" y="222" text-anchor="middle" class="label">4 Cores / 16 Warps</text>
    <text x="495" y="236" text-anchor="middle" class="label" opacity="0.7">L1 I$ 16KB / L1 D$ 32KB</text>
    <text x="495" y="250" text-anchor="middle" class="label" opacity="0.7">Shared Mem 64KB</text>
  </g>

  <g>
    <rect x="590" y="178" width="170" height="88" fill="#2563eb"/>
    <text x="675" y="198" text-anchor="middle" class="heading">SM 3</text>
    <line x1="605" y1="206" x2="745" y2="206" stroke="#fff" stroke-width="0.5" opacity="0.4"/>
    <text x="675" y="222" text-anchor="middle" class="label">4 Cores / 16 Warps</text>
    <text x="675" y="236" text-anchor="middle" class="label" opacity="0.7">L1 I$ 16KB / L1 D$ 32KB</text>
    <text x="675" y="250" text-anchor="middle" class="label" opacity="0.7">Shared Mem 64KB</text>
  </g>

  <!-- SM Row 2 -->
  <rect x="40" y="276" width="170" height="36" fill="#2563eb"/>
  <text x="125" y="299" text-anchor="middle" class="heading">SM 4</text>

  <rect x="220" y="276" width="170" height="36" fill="#2563eb"/>
  <text x="305" y="299" text-anchor="middle" class="heading">SM 5</text>

  <rect x="410" y="276" width="170" height="36" fill="#2563eb"/>
  <text x="495" y="299" text-anchor="middle" class="heading">SM 6</text>

  <rect x="590" y="276" width="170" height="36" fill="#2563eb"/>
  <text x="675" y="299" text-anchor="middle" class="heading">SM 7</text>

  <!-- Connection lines from SMs to interconnect -->
  <line x1="125" y1="312" x2="125" y2="332" stroke="#333" stroke-width="1"/>
  <line x1="305" y1="312" x2="305" y2="332" stroke="#333" stroke-width="1"/>
  <line x1="495" y1="312" x2="495" y2="332" stroke="#333" stroke-width="1"/>
  <line x1="675" y1="312" x2="675" y2="332" stroke="#333" stroke-width="1"/>

  <!-- Crossbar Interconnect -->
  <rect x="40" y="332" width="720" height="28" fill="#111"/>
  <text x="400" y="350" text-anchor="middle" class="heading">Crossbar Interconnect</text>

  <!-- Connection lines from interconnect to L2 -->
  <line x1="210" y1="360" x2="210" y2="382" stroke="#333" stroke-width="1"/>
  <line x1="590" y1="360" x2="590" y2="382" stroke="#333" stroke-width="1"/>

  <!-- L2 Cache -->
  <rect x="100" y="382" width="220" height="44" fill="#059669"/>
  <text x="210" y="404" text-anchor="middle" class="heading">L2 Cache Slice 0</text>
  <text x="210" y="418" text-anchor="middle" class="label" opacity="0.8">256 KB / 8-way</text>

  <rect x="480" y="382" width="220" height="44" fill="#059669"/>
  <text x="590" y="404" text-anchor="middle" class="heading">L2 Cache Slice 1</text>
  <text x="590" y="418" text-anchor="middle" class="label" opacity="0.8">256 KB / 8-way</text>

  <!-- Bus connecting L2 to Memory Controllers -->
  <line x1="210" y1="426" x2="210" y2="446" stroke="#333" stroke-width="1"/>
  <line x1="590" y1="426" x2="590" y2="446" stroke="#333" stroke-width="1"/>
  <line x1="120" y1="446" x2="680" y2="446" stroke="#333" stroke-width="2"/>

  <!-- Vertical lines to mem controllers -->
  <line x1="120" y1="446" x2="120" y2="462" stroke="#333" stroke-width="1"/>
  <line x1="310" y1="446" x2="310" y2="462" stroke="#333" stroke-width="1"/>
  <line x1="490" y1="446" x2="490" y2="462" stroke="#333" stroke-width="1"/>
  <line x1="680" y1="446" x2="680" y2="462" stroke="#333" stroke-width="1"/>

  <!-- Memory Controllers -->
  <rect x="50" y="462" width="140" height="36" fill="#d97706"/>
  <text x="120" y="484" text-anchor="middle" class="heading">Mem Ctrl 0</text>

  <rect x="240" y="462" width="140" height="36" fill="#d97706"/>
  <text x="310" y="484" text-anchor="middle" class="heading">Mem Ctrl 1</text>

  <rect x="420" y="462" width="140" height="36" fill="#d97706"/>
  <text x="490" y="484" text-anchor="middle" class="heading">Mem Ctrl 2</text>

  <rect x="610" y="462" width="140" height="36" fill="#d97706"/>
  <text x="680" y="484" text-anchor="middle" class="heading">Mem Ctrl 3</text>

  <!-- Lines to GDDR -->
  <line x1="120" y1="498" x2="120" y2="518" stroke="#999" stroke-width="1"/>
  <line x1="310" y1="498" x2="310" y2="518" stroke="#999" stroke-width="1"/>
  <line x1="490" y1="498" x2="490" y2="518" stroke="#999" stroke-width="1"/>
  <line x1="680" y1="498" x2="680" y2="518" stroke="#999" stroke-width="1"/>

  <!-- GDDR -->
  <rect x="50" y="518" width="140" height="32" fill="none" stroke="#999" stroke-width="1.5"/>
  <text x="120" y="538" text-anchor="middle" class="label-dark">GDDR6 1GB</text>

  <rect x="240" y="518" width="140" height="32" fill="none" stroke="#999" stroke-width="1.5"/>
  <text x="310" y="538" text-anchor="middle" class="label-dark">GDDR6 1GB</text>

  <rect x="420" y="518" width="140" height="32" fill="none" stroke="#999" stroke-width="1.5"/>
  <text x="490" y="538" text-anchor="middle" class="label-dark">GDDR6 1GB</text>

  <rect x="610" y="518" width="140" height="32" fill="none" stroke="#999" stroke-width="1.5"/>
  <text x="680" y="538" text-anchor="middle" class="label-dark">GDDR6 1GB</text>

  <!-- Total memory note -->
  <text x="400" y="568" text-anchor="middle" class="label-muted">4 GB Total VRAM</text>

</svg>
